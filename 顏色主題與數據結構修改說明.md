# 顏色主題與數據結構修改說明

## 🎨 顏色主題修改

根據用戶需求，已完成以下顏色主題調整：

### 修改前後對比

| 圖層           | 修改前      | 修改後               |
| -------------- | ----------- | -------------------- |
| 數據分析圖層   | 🔴 紅色主題 | 🟢 綠色主題          |
| 等時圈分析圖層 | 🔵 藍色主題 | 🔵 藍色主題 (無變更) |
| 路徑規劃圖層   | 🟢 綠色主題 | 🟠 橘色主題          |

### 具體修改內容

#### 1. 數據分析圖層 → 綠色主題

- **dataStore.js**: `colorName: 'green'`
- **MapTab.vue**: 分析點圖標 `my-color-green`
- **MapTab.vue**: 分析圓圈 `var(--my-color-green)`

#### 2. 路徑規劃圖層 → 橘色主題

- **dataStore.js**: `colorName: 'orange'`
- **MapTab.vue**: 按鈕樣式 `my-btn-orange`
- **MapTab.vue**: 路徑點圖標 `var(--my-color-orange)`

## 📊 數據結構修改

### 路徑規劃圖層數據邏輯調整

#### 修改前：每個路徑點一筆記錄

```javascript
// 舊的表格數據結構
routePlanningLayer.tableData = routePoints.map((feature, index) => ({
  '#': index + 1,
  名稱: feature.properties.name,
  類型: '路徑規劃點',
  緯度: feature.geometry.coordinates[1].toFixed(6),
  經度: feature.geometry.coordinates[0].toFixed(6),
  建立時間: new Date(feature.properties.createdAt).toLocaleString('zh-TW'),
  順序: feature.properties.order,
}));
```

#### 修改後：整個路徑規劃一筆記錄

```javascript
// 新的表格數據結構
if (routePoints.length > 0) {
  const firstPoint = routePoints[0];
  const lastPoint = routePoints[routePoints.length - 1];

  routePlanningLayer.tableData = [
    {
      '#': 1, // 序號固定為1
      名稱: `路徑規劃 (${routePoints.length}個點)`, // 顯示包含的點數
      類型: '路徑規劃',
      起點: `${firstPoint.properties.name}`,
      終點: routePoints.length > 1 ? `${lastPoint.properties.name}` : '同起點',
      路徑點數: routePoints.length,
      建立時間: new Date(firstPoint.properties.createdAt).toLocaleString(
        'zh-TW'
      ),
      狀態: '規劃中',
    },
  ];
}
```

### 摘要統計數據調整

#### 修改前

```javascript
routePlanningLayer.summaryData = {
  totalCount: routePoints.length, // 顯示路徑點數量
  type: '路徑規劃點',
  description: `共 ${routePoints.length} 個路徑規劃點，點選完成後可進行路徑規劃`,
};
```

#### 修改後

```javascript
routePlanningLayer.summaryData = {
  totalCount: 1, // 表格只顯示一筆資料
  type: '路徑規劃',
  description: `正在規劃路徑，已選擇 ${routePoints.length} 個路徑點`,
};
```

## 🎯 用戶體驗改善

### 1. 視覺層次更清晰

- **綠色**: 數據分析 (基礎分析功能)
- **藍色**: 等時圈分析 (進階交通分析)
- **橘色**: 路徑規劃 (路線規劃功能)

### 2. 數據表格更直觀

- **修改前**: 路徑點選過程中，表格會顯示多筆記錄 (路徑點 1、路徑點 2...)
- **修改後**: 整個路徑規劃過程只顯示一筆記錄，清楚顯示包含的點數

### 3. 表格欄位優化

| 欄位     | 說明               | 範例               |
| -------- | ------------------ | ------------------ |
| 名稱     | 顯示路徑規劃和點數 | `路徑規劃 (3個點)` |
| 類型     | 固定顯示           | `路徑規劃`         |
| 起點     | 第一個路徑點名稱   | `路徑點 1`         |
| 終點     | 最後一個路徑點名稱 | `路徑點 3`         |
| 路徑點數 | 總路徑點數量       | `3`                |
| 狀態     | 當前狀態           | `規劃中`           |

## 🔧 技術實現細節

### 文件修改清單

#### dataStore.js

- ✅ 數據分析圖層顏色: `red` → `green`
- ✅ 路徑規劃圖層顏色: `green` → `orange`
- ✅ `updateRoutePlanningLayerData()` 函數邏輯重構
- ✅ 摘要統計數據結構調整
- ✅ 表格數據結構完全重新設計

#### MapTab.vue

- ✅ 數據分析按鈕: 保持 `my-btn-green` (顏色語義變更)
- ✅ 路徑規劃按鈕: `my-btn-purple` → `my-btn-orange`
- ✅ 數據分析圖標: `my-color-red` → `my-color-green`
- ✅ 數據分析圓圈: `var(--my-color-red)` → `var(--my-color-green)`
- ✅ 路徑規劃圖標: `var(--my-color-green)` → `var(--my-color-orange)`
- ✅ 註釋更新: 反映新的顏色主題

#### 路徑規劃圖層功能說明.md

- ✅ 視覺區分說明更新
- ✅ 按鈕狀態說明更新
- ✅ 路徑點特色說明更新
- ✅ 互斥模式說明更新

## 🎨 UI/UX 效果預覽

### 按鈕狀態

```
數據分析:   [點選數據分析位置]     (綠色)  →  [取消數據分析點選]   (紅色)
等時圈分析: [點選等時分析位置]     (藍色)  →  [取消等時圈點選]     (紅色)
路徑規劃:   [點選路徑規劃點]       (橘色)  →  [路徑規劃點選完成]   (紅色)
```

### 地圖圖標

```
數據分析:   🟢 + (綠色加號)
等時圈分析: 🔵 + (藍色加號)
路徑規劃:   🟠 1,2,3... (橘色數字圓圈)
```

### 數據表格顯示

```
路徑規劃過程中:
┌──────────────────────────────────────────────────────────────┐
│ # │ 名稱              │ 類型     │ 起點     │ 終點     │ 路徑點數 │
├───┼─────────────────┼────────┼────────┼────────┼────────┤
│ 1 │ 路徑規劃 (3個點) │ 路徑規劃 │ 路徑點 1 │ 路徑點 3 │    3    │
└───┴─────────────────┴────────┴────────┴────────┴────────┘
```

## ✅ 完成狀態

所有用戶要求的修改已完成：

- ✅ **點選路徑規劃點** → 橘色按鈕
- ✅ **路徑規劃圖層** → 橘色主題
- ✅ **數據分析圖層** → 綠色主題
- ✅ **路徑規劃數據結構** → 同一筆資料顯示
- ✅ **清單顯示** → 只有一筆，顯示包含點數
- ✅ **文檔更新** → 反映所有變更

現在系統具有更清晰的視覺層次和更直觀的數據表格顯示！🎉

---

_此修改提升了系統的視覺一致性和用戶體驗，讓不同分析功能的區別更加明確。_
